<!DOCTYPE html>
<html lang="km">
<head>
  <meta charset="UTF-8">
  <title>á€á¶ášáœá¶á™á¢á€áŸ’áŸášááŸ’á˜áŸ‚áš (Khmer Typing Practice)</title>
  <style>
    body {
      font-family: 'Noto Sans Khmer', sans-serif;
      text-align: center;
      background: #f7f7f7;
      padding: 40px;
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
    }

    #controls {
      margin-bottom: 20px;
    }

    select, button {
      font-size: 16px;
      padding: 10px 15px;
      margin: 5px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    button {
      background: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background: #45a049;
    }

    #textToType {
      background: white;
      padding: 25px;
      border-radius: 12px;
      margin: 30px auto;
      width: 80%;
      font-size: 26px;
      line-height: 1.8;
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      text-align: left;
    }

    #textToType span {
      transition: color 0.1s;
    }

    #inputArea {
      width: 80%;
      font-size: 20px;
      padding: 15px;
      border: 2px solid #ccc;
      border-radius: 8px;
      outline: none;
      margin-top: 10px;
      transition: border-color 0.2s;
    }

    #inputArea:focus {
      border-color: #4CAF50;
    }

    #liveStats {
      font-size: 18px;
      color: #555;
      margin-top: 15px;
    }

    #result {
      margin-top: 30px;
      font-size: 18px;
      animation: fadeIn 0.4s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <h1>á€á¶ášáœá¶á™á¢á€áŸ’áŸášááŸ’á˜áŸ‚áš (Khmer Typing Practice)</h1>

  <div id="controls">
    <label for="difficulty">á‡áŸ’ášá¾áŸášá¾áŸá€á˜áŸ’ášá·ááŸ– </label>
    <select id="difficulty">
      <option value="easy">áŸá¶á˜á‰áŸ’á‰</option>
      <option value="medium">á˜á’áŸ’á™á˜</option>
      <option value="hard">á›áŸ†á”á¶á€</option>
    </select>
    <button id="startBtn">á…á¶á”áŸ‹á•áŸ’áá¾á˜</button>
    <button id="restartBtn" style="display:none;">á…á¶á”áŸ‹á•áŸ’áá¾á˜á˜áŸ’áŠá„á‘áŸ€á</button>
  </div>

  <div id="textToType">á‡áŸ’ášá¾áŸášá¾áŸá€á˜áŸ’ášá·á á á¾á™á…á»á… "á…á¶á”áŸ‹á•áŸ’áá¾á˜" áŠá¾á˜áŸ’á”á¸á…á¶á”áŸ‹á•áŸ’áá¾á˜áœá¶á™áŸ”</div>

  <textarea id="inputArea" rows="4" placeholder="áœá¶á™á¢ááŸ’áá”á‘á“áŸ…á‘á¸á“áŸáŸ‡..." disabled></textarea>
  <div id="liveStats">á›áŸ’á”á¿á“: 0 CPM | á—á¶á–ááŸ’ášá¹á˜ááŸ’ášá¼áœ: 0%</div>
  <div id="result"></div>

  <script>
    const startBtn = document.getElementById('startBtn');
    const restartBtn = document.getElementById('restartBtn');
    const inputArea = document.getElementById('inputArea');
    const result = document.getElementById('result');
    const textDiv = document.getElementById('textToType');
    const stats = document.getElementById('liveStats');
    const difficulty = document.getElementById('difficulty');

    const texts = {
      easy: "ááŸ’á‰á»áŸ†áŸáŸ’ášá›á¶á‰áŸ‹á€á¶ášášáŸ€á“á—á¶áŸá¶ááŸ’á˜áŸ‚ášáŸ”",
      medium: "ááŸ’á‰á»áŸ†áŸáŸ’ášá›á¶á‰áŸ‹á€á¶ášášáŸ€á“á—á¶áŸá¶ááŸ’á˜áŸ‚áš á–á¸á–áŸ’ášáŸ„áŸ‡áœá¶á‡á¶á—á¶áŸá¶áŠáŸ‚á›á˜á¶á“á”áŸ’ášáœááŸ’áá·áŸá¶áŸáŸ’ááŸ’ášá™á¼ášá¢á„áŸ’áœáŸ‚á„áŸ”",
      hard: "á—á¶áŸá¶ááŸ’á˜áŸ‚ášâ€‹á˜á¶á“á–á¶á€áŸ’á™áŸá–áŸ’á‘áŸá˜áŸ’á”á¼ášá”áŸ‚á” á“á·á„á˜á¶á“á¢á€áŸ’áŸášá–á¸ášáŸ„á“á‡á¶á…áŸ’ášá¾á“áŠáŸ‚á›áá˜áŸ’ášá¼áœá²áŸ’á™á¢áŸ’á“á€ášáŸ€á“á™á›áŸ‹á–á¸á…áŸ’á”á¶á”áŸ‹á¢á€áŸ’áŸášáŸá¶áŸáŸ’ááŸ’ášáŸ”"
    };

    let textToType = "";
    let startTime, endTime, started = false;

    difficulty.addEventListener('change', () => {
      textToType = texts[difficulty.value];
      textDiv.innerText = textToType;
    });

    startBtn.addEventListener('click', () => {
      if (!textToType) textToType = texts[difficulty.value];
      textDiv.innerText = textToType;
      inputArea.disabled = false;
      inputArea.value = "";
      inputArea.focus();
      result.innerHTML = "";
      stats.innerText = "á›áŸ’á”á¿á“: 0 CPM | á—á¶á–ááŸ’ášá¹á˜ááŸ’ášá¼áœ: 0%";
      startTime = null;
      started = false;
      startBtn.disabled = true;
      restartBtn.style.display = "none";
    });

    inputArea.addEventListener('paste', (e) => e.preventDefault());

    inputArea.addEventListener('input', () => {
      const typed = inputArea.value;

      if (!started) {
        started = true;
        startTime = new Date();
      }

      // Live color highlighting
      let displayHTML = '';
      for (let i = 0; i < textToType.length; i++) {
        if (i < typed.length) {
          if (typed[i] === textToType[i]) {
            displayHTML += `<span style="color:green">${textToType[i]}</span>`;
          } else {
            displayHTML += `<span style="color:red">${textToType[i]}</span>`;
          }
        } else {
          displayHTML += `<span style="color:#555">${textToType[i]}</span>`;
        }
      }
      textDiv.innerHTML = displayHTML;

      // Real-time stats
      const correctChars = [...typed].filter((c, i) => c === textToType[i]).length;
      const accuracy = Math.round((correctChars / typed.length) * 100) || 0;
      const timeElapsed = (new Date() - startTime) / 1000;
      const cpm = timeElapsed > 0 ? Math.round((typed.length / timeElapsed) * 60) : 0;
      stats.innerText = `á›áŸ’á”á¿á“: ${cpm} CPM | á—á¶á–ááŸ’ášá¹á˜ááŸ’ášá¼áœ: ${accuracy}%`;

      // If finished
      if (typed === textToType) {
        endTime = new Date();
        const timeTaken = (endTime - startTime) / 1000;
        showResults(timeTaken, accuracy, cpm);
      }
    });

    function showResults(timeTaken, accuracy, cpm) {
      inputArea.disabled = true;
      startBtn.disabled = false;
      restartBtn.style.display = "inline-block";
      result.innerHTML = `
        <h3>á›á‘áŸ’á’á•á›:</h3>
        ğŸ•’ á–áŸá›áœáŸá›á¶áŸ– ${timeTaken.toFixed(2)} áœá·á“á¶á‘á¸<br>
        âœ… á—á¶á–ááŸ’ášá¹á˜ááŸ’ášá¼áœáŸ– ${accuracy}%<br>
        âš¡ á›áŸ’á”á¿á“áœá¶á™áŸ– ${cpm} áá½á¢á€áŸ’áŸáš/á“á¶á‘á¸ (CPM)
      `;
    }

    restartBtn.addEventListener('click', () => {
      location.reload();
    });
  </script>
</body>
</html>
